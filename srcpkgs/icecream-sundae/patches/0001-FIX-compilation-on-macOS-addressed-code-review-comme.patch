upstream: yes

From 4c1cd11a34f26b2ec29170a4cd557ffd8b1c30e8 Mon Sep 17 00:00:00 2001
From: Rene Meusel <rene@renemeusel.de>
Date: Mon, 23 Sep 2019 22:19:51 +0200
Subject: [PATCH] FIX: compilation on macOS (addressed code review comments)

---
 meson.build | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/meson.build b/meson.build
index 9b17663..d6c4264 100644
--- a/meson.build
+++ b/meson.build
@@ -10,7 +10,9 @@ project('icecream-sundae', 'cpp',
 
 icecc = dependency('icecc')
 glib = dependency('glib-2.0')
+
 ncurses = dependency('ncursesw')
+ncurses_cxxflag = '-DNCURSES_WIDECHAR'
 
 cxx = meson.get_compiler('cpp')
 
@@ -33,8 +35,8 @@ int main(int argc, char **argv)
 if not cxx.links(code, dependencies: deps, name: 'libicecc links dynamically')
     icecc = dependency('icecc', static: true)
     liblzo2 = cxx.find_library('lzo2')
-    libcapng = dependency('libcap-ng')
-    deps += [libcapng, liblzo2]
+    libcapng = dependency('libcap-ng', required: false)
+    deps += [liblzo2, libcapng, libzstd]
 endif
 
 incdir = include_directories('src')
@@ -64,7 +66,8 @@ icecream_sundae = executable('icecream-sundae',
     ['src/main.cpp', 'src/draw.cpp', 'src/scheduler.cpp', 'src/simulator.cpp'],
     include_directories: incdir,
     dependencies: deps,
-    install : true
+    install : true,
+    cpp_args: ncurses_cxxflag
     )
 
 install_data('icecream-sundae.desktop',
-- 
2.30.0

